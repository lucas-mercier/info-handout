<!DOCTYPE html>
<html  lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-145664552-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-145664552-1');
    </script>
    
      <title>19Portée et visibilité</title>
    
      <link rel="stylesheet" href="../_static/pygments.css">
      <link rel="stylesheet" href="../_static/theme.css">
      
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

      
      <script src="../_static/theme-vendors.js"></script>
      <script src="../_static/theme.js" defer></script>
    
    <link rel="icon" href="../_static/favicon.ico" type="image/x-icon" />
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Recherche" href="../search.html" />
  <link rel="next" title="20Qualité et Testabilité" href="82-testing.html" />
  <link rel="prev" title="18Assemblage différé" href="78-translation-units.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">Le C pour l&#39;ingenieur</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="../index.html#le-c-pour-l-ingenieur"
         class="nav-link  router-link-active">
         Contenu
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#le-c-pour-l-ingenieur"
         class="nav-link ">
         Annexes
      </a>
    </div>
  



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="../index.html#le-c-pour-l-ingenieur"
         class="nav-link  router-link-active">
         Contenu
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#le-c-pour-l-ingenieur"
         class="nav-link ">
         Annexes
      </a>
    </div>
  



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Recherche rapide</span>
    <div class="searchformwrapper">
      <form class="search" action="../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Recherche" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#le-c-pour-l-ingenieur">Contenu</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="05-introduction.html" class="reference internal ">Introduction</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="07-programming.html" class="reference internal ">La programmation</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="10-foundations.html" class="reference internal ">Généralités du langage</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="15-numeration.html" class="reference internal ">Numération</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="17-operators.html" class="reference internal ">Opérateurs</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="20-datatype.html" class="reference internal ">Types de données</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="25-control-structures.html" class="reference internal ">Structures de contrôle</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="30-processus.html" class="reference internal ">Programmes et Processus</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="35-stdio.html" class="reference internal ">Entrées Sorties</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="40-functions.html" class="reference internal ">Fonctions</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="45-compound-datatype.html" class="reference internal ">Types composites</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="50-files.html" class="reference internal ">Les fichiers</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="55-memory-management.html" class="reference internal ">Gestion de la mémoire</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="60-pointers.html" class="reference internal ">Pointeurs</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="70-standard-library.html" class="reference internal ">Bibliothèques</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="75-preprocessor.html" class="reference internal ">Préprocesseur</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="77-algorithms.html" class="reference internal ">Algorithmes et conception</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="78-translation-units.html" class="reference internal ">Assemblage différé</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">Portée et visibilité</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#espace-de-nommage" class="reference internal">Espace de nommage</a></li>
                
                  <li class="toctree-l2"><a href="#portee" class="reference internal">Portée</a></li>
                
                  <li class="toctree-l2"><a href="#visibilite" class="reference internal">Visibilité</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 "><a href="82-testing.html" class="reference internal ">Qualité et Testabilité</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="85-linked-list.html" class="reference internal ">Structures récursives</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="90-advanced-topics.html" class="reference internal ">Avancé</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="92-traps.html" class="reference internal ">Pièges</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="95-philosophy.html" class="reference internal ">Philosophie</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#le-c-pour-l-ingenieur">Annexes</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../appendix/10-vscode.html" class="reference internal ">Visual Studio Code</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../appendix/20-grammar.html" class="reference internal ">Grammaire C</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../appendix/30-doxygen.html" class="reference internal ">Documentation automatique avec Doxygen</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../appendix/40-development.html" class="reference internal ">Environnement de développement</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../appendix/70-unit.html" class="reference internal ">Fiches d'unités</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../appendix/80-laboratories.html" class="reference internal ">Laboratoires</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../appendix/88-summary.html" class="reference internal ">Résumé</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../appendix/99-colophon.html" class="reference internal ">Colophon</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
    <li><span class="section-number">19</span>Portée et visibilité</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="78-translation-units.html"
       title="Chapitre précédent">← <span class="section-number">18</span>Assemblage différé</a>
  </li>
  <li class="next">
    <a href="82-testing.html"
       title="Chapitre suivant"><span class="section-number">20</span>Qualité et Testabilité →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  <div class="section" id="portee-et-visibilite">
<h1><span class="section-number">19</span>Portée et visibilité<a class="headerlink" href="#portee-et-visibilite" title="Lien permanent vers ce titre">¶</a></h1>
<p>Ce chapitre se concentre sur trois caractéristiques d'une variable:</p>
<ul class="simple">
<li><p>La portée</p></li>
<li><p>La visibilité</p></li>
<li><p>La durée de vie</p></li>
</ul>
<p>Dans les trois cas, elles décrivent l'accessibilité, c'est à dire jusqu'à ou/et jusqu'à quand une variable est accessible.</p>
<div class="figure align-default" id="id1">
<img alt="../_images/visibility.jpg" src="../_images/visibility.jpg" />
<p class="caption"><span class="caption-number">Fig. 19.1 </span><span class="caption-text">Brouillard matinal sur le <a class="reference external" href="https://fr.wikipedia.org/wiki/Golden_Gate_Bridge">Golden Gate Bridge</a>, San Francisco.</span></span><a class="headerlink" href="#id1" title="Lien permanent vers cette image">¶</a></p>
</div>
<div class="section" id="espace-de-nommage">
<h2><span class="section-number">19.1</span>Espace de nommage<a class="headerlink" href="#espace-de-nommage" title="Lien permanent vers ce titre">¶</a></h2>
<p>L'espace de nommage ou <code class="docutils literal notranslate"><span class="pre">namespace</span></code> est un concept différent de celui existant dans d'autres langages tel que C++. Le standard <strong>C99</strong> décrit 4 types possibles pour un identifiant:</p>
<ul class="simple">
<li><p>fonction et <em>labels</em></p></li>
<li><p>noms de structures (<code class="docutils literal notranslate"><span class="pre">struct</span></code>), d'unions (<code class="docutils literal notranslate"><span class="pre">union</span></code>), d'énumération (<code class="docutils literal notranslate"><span class="pre">enum</span></code>),</p></li>
<li><p>identifiants</p></li>
</ul>
</div>
<div class="section" id="portee">
<h2><span class="section-number">19.2</span>Portée<a class="headerlink" href="#portee" title="Lien permanent vers ce titre">¶</a></h2>
<p>La portée ou <a class="reference external" href="https://en.wikipedia.org/wiki/Scope_(computer_science)">scope</a> décrit jusqu'à où une variable est accessible.</p>
<p>Une variable est <strong>globale</strong>, c'est-à-dire accessible partout, si elle est déclarée en dehors d'une fonction:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">global_variable</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
</pre></div>
</div>
<p>Une variable est <strong>locale</strong> si elle est déclarée à l'intérieur d'un bloc, ou à l'intérieur d'une fonction. Elle sera ainsi visible de sa déclaration jusqu'à la fin du bloc courant:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// Valide</span>
    <span class="p">}</span>

    <span class="n">i</span><span class="o">++</span><span class="p">;</span> <span class="c1">// Invalide, `i` n&#39;est plus visible.</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="variable-shadowing">
<h3><span class="section-number">19.2.1</span>Variable shadowing<a class="headerlink" href="#variable-shadowing" title="Lien permanent vers ce titre">¶</a></h3>
<p>On dit qu'une variable est <em>shadowed</em> ou <em>masquée</em> si sa déclaration masque une variable préalablement déclarée:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>

<span class="k">for</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%ld&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span> <span class="c1">// Accès à `i` courant et non à `i = 23`</span>
<span class="p">}</span>

<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span> <span class="c1">// Accès à `i = 23`</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="visibilite">
<h2><span class="section-number">19.3</span>Visibilité<a class="headerlink" href="#visibilite" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="visibilite-et-duree-de-vie">
<h3><span class="section-number">19.3.1</span>Visibilité et durée de vie<a class="headerlink" href="#visibilite-et-duree-de-vie" title="Lien permanent vers ce titre">¶</a></h3>
<p>Selon l'endroit où sont déclarées les variables, leur visibilité depuis
les blocs d'instructions est particulière. On distingue les variables
locales, globales à un module (ou fichier) et globales à l'application.
La visibilité d'une variable correspond à la portion de code où la
variable est réellement utilisable. La durée de vie d'une variable
correspond à sa période d'existence lors de l'exécution du programme.</p>
<div class="section" id="variables-locales">
<h4><span class="section-number">19.3.1.1</span>Variables locales<a class="headerlink" href="#variables-locales" title="Lien permanent vers ce titre">¶</a></h4>
<p>Ces variables sont simplement déclarées dans un bloc d'instructions.
Leur portée (ou visibilité) est réduite aux limites du bloc
d'instruction. Ainsi elles sont utilisables dans le bloc et invisibles
hors du bloc.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">fonction</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// variable locale à la fonction</span>
  <span class="c1">// initialisée à chaque appel de la fonction</span>
  <span class="kt">int</span> <span class="n">var_locale</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

  <span class="c1">// code....</span>

  <span class="c1">// fin</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="variables-globales-a-un-module">
<h4><span class="section-number">19.3.1.2</span>Variables globales à un module<a class="headerlink" href="#variables-globales-a-un-module" title="Lien permanent vers ce titre">¶</a></h4>
<p>Ces variables sont déclarées à l'extérieur de tout bloc et donc visibles
dans toute fonction lui appartenant.</p>
<p>Pour contraindre la visibilité des variables au module (ou fichier), on
placera devant le type de ces données le mot-clé <em>static</em>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Module application.c</span>

<span class="c1">// variable uniquement globale au module</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">var_glob_modul</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">fonction</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// code pouvant utiliser var_glob_modul</span>

  <span class="c1">// fin</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="variables-globales-a-l-application">
<h4><span class="section-number">19.3.1.3</span>Variables globales à l'application<a class="headerlink" href="#variables-globales-a-l-application" title="Lien permanent vers ce titre">¶</a></h4>
<p>Ces variables sont déclarées à l'extérieur de tout bloc et donc visibles
dans toute fonction lui appartenant. N'étant pas déclarées comme
<em>static</em>, on peut les atteindre (les lire et les modifier) depuis toute
l'application. Afin de les atteindre, on ajoutera pour chaque module
devant les utiliser, le préfix <em>extern</em>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Module main.c</span>

<span class="c1">// variable globale au module</span>
<span class="kt">int</span> <span class="n">var_glob_appli</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// code pouvant utiliser var_glob_appli</span>
  <span class="p">...</span>
  <span class="c1">// fin</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

<span class="p">}</span>

<span class="c1">// Module calcul.c</span>

<span class="c1">// visibilité sur une variable globale externe au module</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">var_glob_appli</span><span class="p">;</span>


<span class="kt">int</span> <span class="nf">fonction</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// code pouvant utiliser var_glob_appli</span>
  <span class="p">...</span>
  <span class="c1">// fin</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="classes">
<h3><span class="section-number">19.3.2</span>Classes<a class="headerlink" href="#classes" title="Lien permanent vers ce titre">¶</a></h3>
<p>L'attribut définissant la classe d'une variable doit précéder le type de
la variable. Il est optionnel.</p>
<div class="section" id="variables-de-classe-auto">
<h4><span class="section-number">19.3.2.1</span>Variables de classe auto<a class="headerlink" href="#variables-de-classe-auto" title="Lien permanent vers ce titre">¶</a></h4>
<p>La classe <em>auto</em> est celle utilisée par défaut lorsqu'aucune classe
n'est précisée. Les variables automatiques sont visibles uniquement dans
le bloc où elles sont déclarées. Ces variables sont créées sur la pile
mémoire (stack en anglais).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span> <span class="n">type</span> <span class="n">identificateur</span> <span class="o">=</span> <span class="n">valeur_initiale</span><span class="p">;</span>
</pre></div>
</div>
<p>Pour les variables automatiques, le mot-clé <em>auto</em> n'est pas
obligatoire.</p>
</div>
<div class="section" id="variables-de-classe-statique">
<h4><span class="section-number">19.3.2.2</span>Variables de classe statique<a class="headerlink" href="#variables-de-classe-statique" title="Lien permanent vers ce titre">¶</a></h4>
<p>La classe <em>static</em> permet de déclarer des variables dont le contenu est
préservé même lorsque l'on sort du bloc où elles ont été déclarées.
Elles ne sont initialisées qu'une seule fois.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="n">type</span> <span class="n">identificateur</span> <span class="o">=</span> <span class="n">valeur_initiale</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="utilisation-dans-une-fonction">
<h5><span class="section-number">19.3.2.2.1</span>Utilisation dans une fonction<a class="headerlink" href="#utilisation-dans-une-fonction" title="Lien permanent vers ce titre">¶</a></h5>
<p>Les variables de classe <em>static</em> déclarées dans une fonction sont
initialisées au premier appel de cette fonction. Si on sort de la
fonction, le contenu de cette variable est préservé et lorsque l'on
rentre à nouveau dedans, cette variable n'est pas réinitialisée, mais a
conservé sa valeur précédente. On peut qualifier ce comportement d'effet
mémoire.</p>
</div>
<div class="section" id="utilisation-dans-un-module-ou-fichier">
<h5><span class="section-number">19.3.2.2.2</span>Utilisation dans un module ou fichier<a class="headerlink" href="#utilisation-dans-un-module-ou-fichier" title="Lien permanent vers ce titre">¶</a></h5>
<p>Les variables de classe <em>static</em> déclarées dans un module sont
initialisées lors du démarrage de l'application et sont visibles dans
toutes les fonctions présentes dans le module.</p>
<p>En dehors de ce module, il n'est pas possible d'y accéder, même en
indiquant une référence externe à ce genre de variable.</p>
</div>
</div>
<div class="section" id="variables-de-classe-volatile">
<h4><span class="section-number">19.3.2.3</span>Variables de classe volatile<a class="headerlink" href="#variables-de-classe-volatile" title="Lien permanent vers ce titre">¶</a></h4>
<p>La classe <em>volatile</em> permet d'indiquer au compilateur que la variable de
cette classe ne doit pas être stockée dans un registre.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">volatile</span> <span class="n">type</span> <span class="n">identificateur</span> <span class="o">=</span> <span class="n">valeur_initiale</span><span class="p">;</span>
</pre></div>
</div>
<p>Une application simple est l'utilisation d'une variable liée à un
périphérique. Ce dernier est à même de modifier le contenu de cette
variable sans préavis (lors d'un évènement). Le programme doit toujours
accéder à l'espace mémoire de la variable pour donner la 'vraie'
information à chaque utilisation.</p>
</div>
</div>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="78-translation-units.html"
       title="Chapitre précédent">← <span class="section-number">18</span>Assemblage différé</a>
  </li>
  <li class="next">
    <a href="82-testing.html"
       title="Chapitre suivant"><span class="section-number">20</span>Qualité et Testabilité →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright HEIG-VD(c) 2019.
    Mis à jour le 01 nov. 2019 (version 0.2.0-2-g5c41ba3).
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1 with <a href="https://github.com/heig-vd-tin/sphinx_heigvd_theme">HEIG-VD Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>